#cloud-config
package_update: true

package_upgrade: true

packages:
  - aptitude
  - curl
  - git
  - python
  - python-pip

runcmd:
  - git clone --recursive "https://github.com/jacobfgrant/lotus.git" /root/lotus

write_files:
  - path: /etc/cron.d/cron_bootstrap
    owner: root:root
    permissions: 755
    # Make sure this is the correct location for bootstrap.sh
    content: "@reboot root /root/lotus/bootstrap/bootstrap.sh >> /root/bootstrap.log"
    
  - path: /root/bootstrap_variables
    owner: root:root
    permissions: 400
    # Content will be dynamically generated using script on client side
    content:  |
      insert_bootstrap_variables

power_state:
  timeout: 30
  mode: reboot
